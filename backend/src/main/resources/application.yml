spring:
  application:
    name: my-platform-backend


  # 1. DB 설정 (모두 변수로 처리 -> IntelliJ나 서버가 채워줌)
  datasource:
    driverClassName: org.mariadb.jdbc.Driver
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}

  # 2. JPA 기본 설정
  jpa:
    database-platform: org.hibernate.dialect.MariaDBDialect
    open-in-view: false
    defer-datasource-initialization: true  # Flyway 이후 JPA 초기화
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

  # 2-1. Flyway 데이터베이스 마이그레이션 설정
  flyway:
    enabled: true
    baseline-on-migrate: true      # 기존 DB가 있어도 마이그레이션 시작
    baseline-version: 0            # 기존 DB 버전을 0으로 설정
    locations: classpath:db/migration
    validate-on-migrate: true
    out-of-order: false            # 순차적 마이그레이션 강제
    table: flyway_schema_history   # 마이그레이션 이력 테이블

  # 3. 메일 설정
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
            connectiontimeout: 5000
            timeout: 5000
            writetimeout: 5000

  # 4. 기타 설정
  servlet:
    multipart:
      enabled: true
      max-file-size: 100MB
      max-request-size: 100MB
  web:
    resources:
      static-locations: classpath:/static/
      add-mappings: true
  sql:
    init:
      mode: never

# 5. 커스텀 설정
jwt:
  secret: ${JWT_SECRET}
  expiration: 86400000

file:
  upload:
    dir: ${FILE_UPLOAD_DIR}

gold:
  api:
    url: https://www.goldapi.io/api/XAU/KRW
    key: ${GOLD_API_KEY}
    gram-per-don: 3.75
silver:
  api:
    url: https://www.goldapi.io/api/XAG/KRW
    key: ${SILVER_API_KEY}
    gram-per-don: 3.75

# 6. Ollama AI 설정
ollama:
  url: ${OLLAMA_URL:http://localhost:11434}
  model: ${OLLAMA_MODEL:gemma2:2b}

# Gemini AI 설정
gemini:
  api:
    key: ${GEMINI_API_KEY:}
    url: https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent

# 7. 한국투자증권 API 설정
kis:
  api:
    app-key: ${KIS_APP_KEY:}
    app-secret: ${KIS_APP_SECRET:}
    base-url: ${KIS_BASE_URL:https://openapi.koreainvestment.com:9443}
    # 모의투자: https://openapivts.koreainvestment.com:29443

# 8. Reddit API 설정
reddit:
  api:
    client-id: ${REDDIT_CLIENT_ID:}
    client-secret: ${REDDIT_CLIENT_SECRET:}
    user-agent: ${REDDIT_USER_AGENT:my-platform/1.0}
    username: ${REDDIT_USERNAME:}
    password: ${REDDIT_PASSWORD:}

# 9. 텔레그램 알림 설정
telegram:
  bot:
    token: ${TELEGRAM_BOT_TOKEN:}
    chat-id: ${TELEGRAM_CHAT_ID:}
    enabled: ${TELEGRAM_ENABLED:false}

# 10. 알림 스케줄러 설정
alert:
  scheduler:
    enabled: ${ALERT_SCHEDULER_ENABLED:false}

# 7. Swagger
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha